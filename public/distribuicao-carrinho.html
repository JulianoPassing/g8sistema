<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>G8 Representa√ß√µes - Loja Distribui√ß√£o</title>
    <link rel="icon" href="https://i.imgur.com/WveVVY5.png" type="image/png" />
    <link rel="apple-touch-icon" href="https://i.imgur.com/WveVVY5.png" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="modern-design.css">
    <link rel="stylesheet" href="mobile.css">
    <link rel="stylesheet" href="connection-status.css">
    <script src="advanced-notifications.js"></script>
    <script src="animations.js"></script>
    <script src="offline-system.js"></script>
    <script src="connection-monitor.js"></script>

    <style>
      :root {
        /* === CORES G8 === */
        --g8-red: #ff0000;
        --g8-black: #000000;
        --g8-white: #ffffff;
        
        --primary-color: #ff0000;
        --primary-hover: #cc0000;
        --secondary-color: #000000;
        --success-color: #059669;
        --success-hover: #047857;
        --danger-color: #dc2626;
        --danger-hover: #b91c1c;
        --warning-color: #d97706;
        --warning-hover: #b45309;
        --light-color: #ffffff;
        --dark-color: #000000;
        --text-color: #000000;
        --text-muted: #666666;
        --bg-color: #ffffff;
        --card-bg: #fafafa;
        --border-color: #e0e0e0;
        --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
        --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        --shadow-red: 0 10px 40px rgba(255, 0, 0, 0.25);
        --border-radius: 8px;
        --border-radius-lg: 12px;
        --border-radius-xl: 16px;
        --gradient-primary: linear-gradient(135deg, #ff0000 0%, #cc0000 100%);
        --gradient-secondary: linear-gradient(135deg, #000000 0%, #333333 100%);
        --gradient-success: linear-gradient(135deg, #059669 0%, #047857 100%);
        --gradient-danger: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
        --gradient-dark: linear-gradient(135deg, #1e293b 0%, #000000 100%);
        --gradient-bg: linear-gradient(135deg, #ffffff 0%, #f5f5f5 100%);
      }

      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        line-height: 1.6;
        color: var(--text-color);
        background: var(--bg-color);
        margin: 0;
        padding: 80px 20px 0 20px;
        font-size: 14px;
        min-height: 100vh;
        position: relative;
        display: flex;
        flex-direction: column;
      }

      /* Fundo animado sutil */
      body::before {
        content: '';
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: 
          radial-gradient(circle at 20% 80%, rgba(255, 0, 0, 0.05) 0%, transparent 50%),
          radial-gradient(circle at 80% 20%, rgba(0, 0, 0, 0.08) 0%, transparent 50%),
          radial-gradient(circle at 40% 40%, rgba(255, 0, 0, 0.03) 0%, transparent 50%);
        animation: backgroundFloat 25s ease-in-out infinite;
        z-index: -1;
      }

      @keyframes backgroundFloat {
        0%, 100% { transform: translateX(0) translateY(0); }
        50% { transform: translateX(-15px) translateY(15px); }
      }

      /* --- HEADER DE USU√ÅRIO E LOGOUT --- */
      .header-top {
        width: 100%;
        position: absolute;
        top: 0;
        left: 0;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 15px 25px;
        background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
        box-shadow: var(--shadow);
        z-index: 1000;
        border-bottom: 1px solid var(--border-color);
        height: 70px;
        box-sizing: border-box;
      }

      .header-left {
        flex: 0 0 auto;
        display: flex;
        align-items: center;
        gap: 15px;
      }

      .header-center {
        position: absolute;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
      }

      .header-center img {
        height: 45px;
        width: auto;
      }

      .header-right {
        flex: 0 0 auto;
        display: flex;
        align-items: center;
        gap: 12px;
      }

      #user-info {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        font-size: 0.9rem;
        color: var(--text-color);
        font-weight: 500;
      }

      #logout-button, .btn {
        background: var(--gradient-primary);
        color: white;
        border: none;
        padding: 8px 16px;
        border-radius: var(--border-radius);
        cursor: pointer;
        font-size: 0.9rem;
        font-weight: 600;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 5px;
        transition: all 0.3s ease;
        box-shadow: var(--shadow-sm);
      }

      #logout-button:hover, .btn:hover {
        background: var(--primary-hover);
        transform: translateY(-1px);
        box-shadow: var(--shadow);
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
      }

      /* Grid de produtos */
      .produtos-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
      }

      @media (min-width: 1200px) {
        .produtos-grid {
          grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
          gap: 24px;
        }
      }

      /* Cards de produtos */
      .produto-card {
        background: var(--card-bg);
        border-radius: var(--border-radius-lg);
        padding: 18px;
        box-shadow: var(--shadow);
        border: 1px solid var(--border-color);
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
        height: fit-content;
      }

      .produto-card:hover {
        box-shadow: var(--shadow-lg);
        transform: translateY(-4px);
        border-color: var(--primary-color);
      }

      .produto-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: var(--gradient-primary);
        transform: scaleX(0);
        transition: transform 0.3s ease;
      }

      .produto-card:hover::before {
        transform: scaleX(1);
      }

      .produto-imagem {
        width: 100%;
        height: 180px;
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        border-radius: var(--border-radius);
        margin-bottom: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--text-muted);
        font-size: 2.5rem;
        border: 2px dashed var(--border-color);
        transition: all 0.3s ease;
        overflow: hidden;
      }

      .produto-imagem img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        border-radius: var(--border-radius);
      }

      .produto-imagem:hover {
        border-color: var(--primary-color);
        background: linear-gradient(135deg, #fff0f0 0%, #ffe6e6 100%);
      }

      .produto-ref {
        font-size: 1.1rem;
        font-weight: 700;
        color: var(--primary-color);
        margin-bottom: 6px;
        text-align: center;
      }

      .produto-descricao {
        font-size: 0.95rem;
        font-weight: 600;
        color: var(--text-color);
        margin-bottom: 8px;
        line-height: 1.3;
        text-align: center;
        min-height: 2.6rem;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .produto-categoria {
        font-size: 0.8rem;
        color: var(--text-muted);
        background: rgba(0, 0, 0, 0.05);
        padding: 4px 8px;
        border-radius: 12px;
        margin-bottom: 8px;
        text-align: center;
        font-weight: 500;
      }

      .produto-tamanhos {
        font-size: 0.85rem;
        color: var(--text-muted);
        margin-bottom: 12px;
        text-align: center;
        line-height: 1.2;
      }

      .produto-preco {
        font-size: 1.3rem;
        font-weight: 700;
        color: var(--success-color);
        margin-bottom: 12px;
        text-align: center;
      }

      /* Sistema de tamanhos como Pantaneiro5 */
      .tamanhos-container {
        margin-bottom: 15px;
      }

      .tamanhos-container label {
        display: block;
        margin-bottom: 8px;
        font-weight: 600;
        color: var(--text-color);
        font-size: 0.9rem;
        text-align: center;
      }

      .tamanho-input-container {
        display: flex;
        flex-wrap: wrap;
        gap: 6px;
        align-items: center;
        justify-content: center;
      }

      .tamanho-input-container > div {
        display: flex;
        align-items: center;
        gap: 4px;
        background: rgba(255, 255, 255, 0.8);
        padding: 6px 8px;
        border-radius: 8px;
        border: 1px solid var(--border-color);
        transition: all 0.3s ease;
      }

      .tamanho-input-container > div:hover {
        border-color: var(--primary-color);
        background: rgba(255, 0, 0, 0.05);
      }

      .tamanho-input-container label {
        font-size: 0.75rem;
        font-weight: 600;
        margin: 0;
        color: var(--text-color);
        white-space: nowrap;
      }

      .tamanho-input-container input[type="number"] {
        width: 45px;
        padding: 4px 6px;
        text-align: center;
        border: 1px solid var(--border-color);
        border-radius: 4px;
        font-size: 0.8rem;
        font-weight: 600;
        background: white;
      }

      .tamanho-input-container input[type="number"]:focus {
        outline: none;
        border-color: var(--primary-color);
        box-shadow: 0 0 0 2px rgba(255, 0, 0, 0.1);
      }

      .manual-tamanho-input {
        width: 100%;
        padding: 8px 12px;
        border: 2px solid var(--border-color);
        border-radius: var(--border-radius);
        font-size: 0.9rem;
        margin-bottom: 10px;
        text-align: center;
      }

      .manual-tamanho-input:focus {
        outline: none;
        border-color: var(--primary-color);
        box-shadow: 0 0 0 3px rgba(255, 0, 0, 0.1);
      }

      .btn-adicionar {
        width: 100%;
        background: var(--gradient-success);
        color: white;
        border: none;
        padding: 10px;
        border-radius: var(--border-radius);
        font-size: 0.95rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 6px;
      }

      .btn-adicionar:hover {
        background: var(--success-hover);
        transform: translateY(-2px);
        box-shadow: var(--shadow);
      }

      .btn-adicionar:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none;
      }

      /* Carrinho lateral */
      .carrinho-sidebar {
        position: fixed;
        top: 0;
        right: -400px;
        width: 400px;
        height: 100vh;
        background: white;
        box-shadow: var(--shadow-xl);
        transition: right 0.3s ease;
        z-index: 1001;
        display: flex;
        flex-direction: column;
      }

      .carrinho-sidebar.open {
        right: 0;
      }

      .carrinho-header {
        padding: 20px;
        background: var(--gradient-primary);
        color: white;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .carrinho-header h3 {
        margin: 0;
        font-size: 1.2rem;
      }

      .btn-fechar-carrinho {
        background: none;
        border: none;
        color: white;
        font-size: 1.5rem;
        cursor: pointer;
        padding: 5px;
        border-radius: 50%;
        transition: all 0.3s ease;
      }

      .btn-fechar-carrinho:hover {
        background: rgba(255, 255, 255, 0.2);
      }

      .carrinho-content {
        flex: 1;
        overflow-y: auto;
        padding: 20px;
      }

      .carrinho-item {
        display: flex;
        align-items: center;
        gap: 15px;
        padding: 15px 0;
        border-bottom: 1px solid var(--border-color);
      }

      .carrinho-item-imagem {
        width: 60px;
        height: 60px;
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        border-radius: var(--border-radius);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        color: var(--text-muted);
      }

      .carrinho-item-info {
        flex: 1;
      }

      .carrinho-item-nome {
        font-weight: 600;
        margin-bottom: 5px;
      }

      .carrinho-item-detalhes {
        font-size: 0.9rem;
        color: var(--text-muted);
        margin-bottom: 5px;
      }

      .carrinho-item-preco {
        font-weight: 600;
        color: var(--success-color);
      }

      .carrinho-item-quantidade {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-top: 8px;
      }

      .carrinho-item-quantidade input {
        width: 50px;
        text-align: center;
        padding: 4px;
        border: 1px solid var(--border-color);
        border-radius: 4px;
      }

      .btn-remover-item {
        background: var(--gradient-danger);
        color: white;
        border: none;
        padding: 4px 8px;
        border-radius: 4px;
        cursor: pointer;
        font-size: 0.8rem;
        transition: all 0.3s ease;
      }

      .btn-remover-item:hover {
        background: var(--danger-hover);
      }

      .carrinho-footer {
        padding: 20px;
        background: var(--card-bg);
        border-top: 1px solid var(--border-color);
      }

      .carrinho-total {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
        font-size: 1.2rem;
        font-weight: 700;
      }

      .carrinho-total-valor {
        color: var(--primary-color);
      }

      .opcoes-pagamento {
        margin-bottom: 20px;
      }

      .opcao-pagamento {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 10px;
        padding: 10px;
        border: 2px solid var(--border-color);
        border-radius: var(--border-radius);
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .opcao-pagamento:hover {
        border-color: var(--primary-color);
      }

      .opcao-pagamento.selecionada {
        border-color: var(--primary-color);
        background: rgba(255, 0, 0, 0.05);
      }

      .opcao-pagamento input[type="radio"] {
        accent-color: var(--primary-color);
      }

      .desconto-info {
        background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
        border: 1px solid #ffeaa7;
        border-radius: var(--border-radius);
        padding: 10px;
        margin-bottom: 15px;
        color: #856404;
        font-size: 0.9rem;
      }

      .btn-finalizar {
        width: 100%;
        background: var(--gradient-primary);
        color: white;
        border: none;
        padding: 15px;
        border-radius: var(--border-radius);
        font-size: 1.1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .btn-finalizar:hover {
        background: var(--primary-hover);
        transform: translateY(-2px);
        box-shadow: var(--shadow);
      }

      .btn-finalizar:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none;
      }

      /* Bot√£o do carrinho flutuante */
      .btn-carrinho-flutuante {
        position: fixed;
        bottom: 30px;
        right: 30px;
        background: var(--gradient-primary);
        color: white;
        border: none;
        width: 60px;
        height: 60px;
        border-radius: 50%;
        cursor: pointer;
        font-size: 1.5rem;
        box-shadow: var(--shadow-lg);
        transition: all 0.3s ease;
        z-index: 1000;
      }

      .btn-carrinho-flutuante:hover {
        transform: scale(1.1);
        box-shadow: var(--shadow-red);
      }

      .carrinho-badge {
        position: absolute;
        top: -5px;
        right: -5px;
        background: var(--danger-color);
        color: white;
        border-radius: 50%;
        width: 25px;
        height: 25px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.8rem;
        font-weight: 600;
      }

      /* Overlay */
      .overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 1000;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s ease;
      }

      .overlay.show {
        opacity: 1;
        visibility: visible;
      }

      /* Responsividade */
      @media (max-width: 768px) {
        .header-top {
          padding: 15px;
          height: 85px;
          flex-direction: column;
          gap: 10px;
          align-items: center;
          justify-content: center;
        }
        
        .header-left {
          display: flex;
        }
        
        .header-center {
          position: static;
          transform: none;
          order: 1;
        }
        
        .header-center img {
          width: 200px;
          height: auto;
          max-width: 80%;
        }
        
        .header-right {
          order: 2;
          width: 100%;
          justify-content: space-between;
          gap: 8px;
        }
        
        #user-info {
          font-size: 0.75rem;
          flex: 1;
          text-align: center;
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
        }
        
        #logout-button, .btn {
          padding: 6px 10px;
          font-size: 0.75rem;
          min-width: auto;
          flex-shrink: 0;
        }

        body {
          padding-top: 80px;
        }

        .produtos-grid {
          grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
          gap: 15px;
        }

        .carrinho-sidebar {
          width: 100%;
          right: -100%;
        }

        .btn-carrinho-flutuante {
          bottom: 20px;
          right: 20px;
          width: 50px;
          height: 50px;
          font-size: 1.2rem;
        }
      }

      @media (max-width: 480px) {
        .header-center img {
          width: 150px;
          max-width: 75%;
        }

        .produtos-grid {
          grid-template-columns: 1fr;
          gap: 10px;
        }

        .produto-card {
          padding: 15px;
        }

        .produto-imagem {
          height: 150px;
          font-size: 2rem;
        }
      }

      /* Rodap√© G8 */
      footer {
        width: 100%;
        text-align: center;
        padding: 15px 20px;
        background: transparent;
        color: #000000;
        margin-top: 40px;
        position: relative;
        font-size: 0.85rem;
        font-weight: 500;
      }
    </style>
  </head>
  <body class="g8-theme-g8-default">
    <header class="header-top">
      <div class="header-left">
        <div class="status-indicator" id="connection-status">
          <div class="status-dot"></div>
          <span>Online</span>
        </div>
      </div>
      <div class="header-center">
        <img
          id="logo"
          src="https://i.imgur.com/vjq26ym.png"
          alt="Logo G8"
        />
      </div>
      <div class="header-right">
        <div id="user-info">Carregando...</div>
        <button id="logout-button" onclick="logout()">Sair</button>
      </div>
    </header>

    <main class="container">
      <!-- Se√ß√£o de Filtros -->
      <section class="card">
        <div class="card-header">
          <span role="img" aria-label="Filtros" style="font-size: 1.8em">üîç</span>
          <h2>Filtros e Busca</h2>
        </div>
        
        <div style="padding: 20px;">
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 20px;">
            <div class="form-group">
              <label for="busca-produto">üîç Buscar Produto:</label>
              <input type="text" id="busca-produto" placeholder="Digite refer√™ncia ou descri√ß√£o..." style="width: 100%; padding: 10px 12px; border: 2px solid var(--border-color); border-radius: var(--border-radius); font-size: 0.9rem; transition: all 0.3s ease;">
            </div>
            
            <div class="form-group">
              <label for="filtro-categoria">üì¶ Categoria:</label>
              <select id="filtro-categoria" style="width: 100%; padding: 10px 12px; border: 2px solid var(--border-color); border-radius: var(--border-radius); font-size: 0.9rem; transition: all 0.3s ease;">
                <option value="">Todas as categorias</option>
                <option value="PVC">PVC</option>
                <option value="Nylon">Nylon</option>
                <option value="Feminino">Feminino</option>
                <option value="Premium">Premium</option>
                <option value="Luxo">Luxo</option>
                <option value="Cal√ßados">Cal√ßados</option>
                <option value="Motos">Motos</option>
              </select>
            </div>
            
            <div class="form-group">
              <label for="filtro-preco">üí∞ Faixa de Pre√ßo:</label>
              <select id="filtro-preco" style="width: 100%; padding: 10px 12px; border: 2px solid var(--border-color); border-radius: var(--border-radius); font-size: 0.9rem; transition: all 0.3s ease;">
                <option value="">Todos os pre√ßos</option>
                <option value="0-50">At√© R$ 50,00</option>
                <option value="50-100">R$ 50,00 - R$ 100,00</option>
                <option value="100-150">R$ 100,00 - R$ 150,00</option>
                <option value="150-200">R$ 150,00 - R$ 200,00</option>
                <option value="200+">Acima de R$ 200,00</option>
              </select>
            </div>
            
            <div class="form-group">
              <label for="ordenar-por">üìä Ordenar por:</label>
              <select id="ordenar-por" style="width: 100%; padding: 10px 12px; border: 2px solid var(--border-color); border-radius: var(--border-radius); font-size: 0.9rem; transition: all 0.3s ease;">
                <option value="nome">Nome A-Z</option>
                <option value="preco-asc">Menor Pre√ßo</option>
                <option value="preco-desc">Maior Pre√ßo</option>
                <option value="categoria">Categoria</option>
              </select>
            </div>
          </div>
          
          <div style="text-align: center;">
            <button onclick="limparFiltros()" style="background: var(--gradient-secondary); color: white; border: none; padding: 10px 20px; border-radius: var(--border-radius); font-size: 0.9rem; font-weight: 600; cursor: pointer; transition: all 0.3s ease; margin-right: 10px;">
              üóëÔ∏è Limpar Filtros
            </button>
            <span id="contador-produtos" style="color: var(--text-muted); font-size: 0.9rem; font-weight: 600;"></span>
          </div>
        </div>
      </section>

      <!-- Se√ß√£o de Produtos -->
      <section class="card">
        <div class="card-header">
          <span role="img" aria-label="Loja" style="font-size: 1.8em">üõí</span>
          <h2>Produtos Dispon√≠veis</h2>
        </div>
        
        <div class="produtos-grid" id="produtos-grid">
          <!-- Produtos ser√£o carregados aqui -->
        </div>
        
        <div id="nenhum-produto" style="display: none; text-align: center; padding: 40px 20px; color: var(--text-muted);">
          <div style="font-size: 3rem; margin-bottom: 15px;">üîç</div>
          <h3>Nenhum produto encontrado</h3>
          <p style="margin-top: 10px;">Tente ajustar os filtros para encontrar o que procura.</p>
        </div>
      </section>
    </main>
    
    <footer>
      ¬© 2025 J.P Sistemas. Todos os direitos reservados. | <a href="https://whatsa.me/5548996852138/?t=Ol%C3%A1,%20gostaria%20de%20mais%20informa%C3%A7%C3%B5es%20sobre%20os%20sistemas." target="_blank" style="color: #000000; text-decoration: underline;">jp-sistemas.com</a>
    </footer>

    <!-- Bot√£o do carrinho flutuante -->
    <button class="btn-carrinho-flutuante" onclick="toggleCarrinho()">
      üõí
      <span class="carrinho-badge" id="carrinho-badge" style="display: none;">0</span>
    </button>

    <!-- Overlay -->
    <div class="overlay" id="overlay" onclick="toggleCarrinho()"></div>

    <!-- Carrinho lateral -->
    <div class="carrinho-sidebar" id="carrinho-sidebar">
      <div class="carrinho-header">
        <h3>üõí Seu Carrinho</h3>
        <button class="btn-fechar-carrinho" onclick="toggleCarrinho()">√ó</button>
      </div>
      
      <div class="carrinho-content" id="carrinho-content">
        <div id="carrinho-vazio" style="text-align: center; color: var(--text-muted); padding: 40px 20px;">
          <div style="font-size: 3rem; margin-bottom: 15px;">üõí</div>
          <p>Seu carrinho est√° vazio</p>
          <p style="font-size: 0.9rem; margin-top: 10px;">Adicione produtos para come√ßar suas compras</p>
        </div>
      </div>
      
      <div class="carrinho-footer" id="carrinho-footer" style="display: none;">
        <div class="carrinho-total">
          <span>Total:</span>
          <span class="carrinho-total-valor" id="carrinho-total">R$ 0,00</span>
        </div>
        
        <div class="opcoes-pagamento">
          <div class="opcao-pagamento" onclick="selecionarPagamento('vista')">
            <input type="radio" name="pagamento" value="vista" id="pagamento-vista">
            <label for="pagamento-vista">
              <strong>√Ä Vista</strong> - 5% de desconto
            </label>
          </div>
          <div class="opcao-pagamento" onclick="selecionarPagamento('prazo')">
            <input type="radio" name="pagamento" value="prazo" id="pagamento-prazo">
            <label for="pagamento-prazo">
              <strong>A Prazo</strong> - Pre√ßo normal
            </label>
          </div>
        </div>
        
        <div class="desconto-info" id="desconto-info" style="display: none;">
          <strong>üí∞ Desconto √† vista aplicado!</strong><br>
          Voc√™ est√° economizando <span id="valor-desconto">R$ 0,00</span> com o pagamento √† vista.
        </div>
        
        <button class="btn-finalizar" id="btn-finalizar" onclick="finalizarPedido()" disabled>
          Finalizar Pedido
        </button>
      </div>
    </div>

    <script>
      let clienteData = null;
      let carrinhoItens = [];
      let formaPagamento = null;

      // Verificar autentica√ß√£o
      function checkAuth() {
        const clienteStr = localStorage.getItem('clienteDistribuicao');
        if (!clienteStr) {
          window.location.href = 'distribuicao.html';
          return false;
        }
        
        clienteData = JSON.parse(clienteStr);
        return true;
      }

      // Fun√ß√£o de logout
      function logout() {
        localStorage.removeItem('clienteDistribuicao');
        localStorage.removeItem('savedCnpjDistribuicao');
        localStorage.removeItem('savedPasswordDistribuicao');
        window.location.href = 'distribuicao.html';
      }

      // Preencher informa√ß√µes do cliente
      function preencherInformacoesCliente() {
        if (!clienteData) return;
        document.getElementById('user-info').textContent = clienteData.razao;
      }

      // Produtos da loja de distribui√ß√£o
      const produtosLoja = [
        // Conjuntos PVC
        {
          REFERENCIA: "2900",
          DESCRI√á√ÉO: "CONJUNTO PVC TORNADO COM GOLA E BOLSO",
          TAMANHOS: ["P", "M", "G", "GG", "EX"],
          TAMANHOS_ESPECIAIS: ["EX", "EXG", "2G", "3G"],
          PRECO: 85.00,
          PRECO_ESPECIAL: 97.50,
          CATEGORIA: "PVC",
          IMAGEM: "https://via.placeholder.com/300x200/ff0000/ffffff?text=CONJUNTO+PVC+TORNADO"
        },
        {
          REFERENCIA: "2902",
          DESCRI√á√ÉO: "JAQUETA PVC TORNADO COM GOLA E BOLSO",
          TAMANHOS: ["P", "M", "G", "GG", "EX"],
          TAMANHOS_ESPECIAIS: ["EXG", "2G", "3G"],
          PRECO: 49.00,
          PRECO_ESPECIAL: 57.00,
          CATEGORIA: "PVC",
          IMAGEM: "https://via.placeholder.com/300x200/ff0000/ffffff?text=JAQUETA+PVC+TORNADO"
        },
        {
          REFERENCIA: "2904",
          DESCRI√á√ÉO: "CAL√áA PVC TORNADO",
          TAMANHOS: ["P", "M", "G", "GG", "EX"],
          TAMANHOS_ESPECIAIS: ["EXG", "2G", "3G"],
          PRECO: 38.00,
          PRECO_ESPECIAL: 44.00,
          CATEGORIA: "PVC",
          IMAGEM: "https://via.placeholder.com/300x200/ff0000/ffffff?text=CAL√áA+PVC+TORNADO"
        },
        {
          REFERENCIA: "3000",
          DESCRI√á√ÉO: "CONJUNTO PVC FEMININO COM GOLA - PRETO",
          TAMANHOS: ["P", "M", "G", "GG", "EX"],
          TAMANHOS_ESPECIAIS: ["EXG"],
          PRECO: 87.00,
          PRECO_ESPECIAL: 100.00,
          CATEGORIA: "Feminino",
          IMAGEM: "https://via.placeholder.com/300x200/ff0000/ffffff?text=CONJUNTO+FEMININO+PRETO"
        },
        {
          REFERENCIA: "3000PT/RP",
          DESCRI√á√ÉO: "CONJUNTO PVC FEMININO COM GOLA - PRETO COM CORES",
          TAMANHOS: ["P", "M", "G", "GG", "EX"],
          TAMANHOS_ESPECIAIS: ["EXG"],
          PRECO: 91.00,
          PRECO_ESPECIAL: 105.00,
          CATEGORIA: "Feminino",
          IMAGEM: "https://via.placeholder.com/300x200/ff0000/ffffff?text=CONJUNTO+FEMININO+CORES"
        },
        {
          REFERENCIA: "2000",
          DESCRI√á√ÉO: "CONJUNTO PVC PREMIUM COM GOLA, BOLSO E REFLETIVO",
          TAMANHOS: ["P", "M", "G", "GG", "EX"],
          TAMANHOS_ESPECIAIS: ["EXG", "2G", "3G"],
          PRECO: 114.00,
          PRECO_ESPECIAL: 131.00,
          CATEGORIA: "Premium",
          IMAGEM: "https://via.placeholder.com/300x200/ff0000/ffffff?text=CONJUNTO+PVC+PREMIUM"
        },
        
        // Conjuntos Nylon
        {
          REFERENCIA: "1000",
          DESCRI√á√ÉO: "CONJUNTO NYLON C/GOLA",
          TAMANHOS: ["P", "M", "G", "GG", "EX"],
          TAMANHOS_ESPECIAIS: ["EXG"],
          PRECO: 156.00,
          PRECO_ESPECIAL: 180.00,
          CATEGORIA: "Nylon",
          IMAGEM: "https://via.placeholder.com/300x200/0066cc/ffffff?text=CONJUNTO+NYLON"
        },
        {
          REFERENCIA: "1002",
          DESCRI√á√ÉO: "JAQUELA DE NYLON C/GOLA",
          TAMANHOS: ["P", "M", "G", "GG", "EX"],
          TAMANHOS_ESPECIAIS: ["EXG"],
          PRECO: 92.00,
          PRECO_ESPECIAL: 105.00,
          CATEGORIA: "Nylon",
          IMAGEM: "https://via.placeholder.com/300x200/0066cc/ffffff?text=JAQUETA+NYLON"
        },
        {
          REFERENCIA: "1004",
          DESCRI√á√ÉO: "CAL√áA NYLON",
          TAMANHOS: ["P", "M", "G", "GG", "EX"],
          TAMANHOS_ESPECIAIS: ["EXG"],
          PRECO: 59.00,
          PRECO_ESPECIAL: 68.00,
          CATEGORIA: "Nylon",
          IMAGEM: "https://via.placeholder.com/300x200/0066cc/ffffff?text=CAL√áA+NYLON"
        },
        {
          REFERENCIA: "1100",
          DESCRI√á√ÉO: "CONJUNTO NYLON FEMININO COM GOLA",
          TAMANHOS: ["P", "M", "G", "GG", "EX"],
          TAMANHOS_ESPECIAIS: ["EXG"],
          PRECO: 151.00,
          PRECO_ESPECIAL: 174.00,
          CATEGORIA: "Feminino",
          IMAGEM: "https://via.placeholder.com/300x200/0066cc/ffffff?text=CONJUNTO+NYLON+FEMININO"
        },
        {
          REFERENCIA: "1100PT/RP",
          DESCRI√á√ÉO: "CONJUNTO NYLON FEMININO COM GOLA ROSA",
          TAMANHOS: ["P", "M", "G", "GG", "EX"],
          TAMANHOS_ESPECIAIS: ["EXG"],
          PRECO: 156.00,
          PRECO_ESPECIAL: 180.00,
          CATEGORIA: "Feminino",
          IMAGEM: "https://via.placeholder.com/300x200/ff69b4/ffffff?text=CONJUNTO+NYLON+ROSA"
        },
        {
          REFERENCIA: "1200",
          DESCRI√á√ÉO: "CONJUNTO NYLON LUXO COM FORRO E GOLA",
          TAMANHOS: ["P", "M", "G", "GG", "EX"],
          TAMANHOS_ESPECIAIS: ["EXG"],
          PRECO: 184.00,
          PRECO_ESPECIAL: 212.00,
          CATEGORIA: "Luxo",
          IMAGEM: "https://via.placeholder.com/300x200/0066cc/ffffff?text=CONJUNTO+NYLON+LUXO"
        },
        
        // Botas PVC
        {
          REFERENCIA: "360",
          DESCRI√á√ÉO: "BOTA DE PVC IMPERME√ÅVEL - PRETA",
          TAMANHOS: ["35/36", "37/38", "39/40", "41/42", "43/44"],
          TAMANHOS_ESPECIAIS: [],
          PRECO: 84.00,
          PRECO_ESPECIAL: 84.00,
          CATEGORIA: "Cal√ßados",
          IMAGEM: "https://via.placeholder.com/300x200/333333/ffffff?text=BOTA+PVC+PRETA"
        },
        {
          REFERENCIA: "360C/RS",
          DESCRI√á√ÉO: "BOTA DE PVC IMPERME√ÅVEL - ROSA",
          TAMANHOS: ["35/36", "37/38", "39/40", "41/42", "43/44"],
          TAMANHOS_ESPECIAIS: [],
          PRECO: 92.00,
          PRECO_ESPECIAL: 92.00,
          CATEGORIA: "Cal√ßados",
          IMAGEM: "https://via.placeholder.com/300x200/ff69b4/ffffff?text=BOTA+PVC+ROSA"
        },
        {
          REFERENCIA: "360C/AMF",
          DESCRI√á√ÉO: "BOTA DE PVC IMPERME√ÅVEL - AMARELO",
          TAMANHOS: ["35/36", "37/38", "39/40", "41/42", "43/44"],
          TAMANHOS_ESPECIAIS: [],
          PRECO: 92.00,
          PRECO_ESPECIAL: 92.00,
          CATEGORIA: "Cal√ßados",
          IMAGEM: "https://via.placeholder.com/300x200/ffd700/333333?text=BOTA+PVC+AMARELO"
        },
        {
          REFERENCIA: "370",
          DESCRI√á√ÉO: "BOTA DE PVC IMPERME√ÅVEL CANO M√âDIO",
          TAMANHOS: ["35/36", "37/38", "39/40", "41/42", "43/44", "45/46"],
          TAMANHOS_ESPECIAIS: [],
          PRECO: 91.00,
          PRECO_ESPECIAL: 91.00,
          CATEGORIA: "Cal√ßados",
          IMAGEM: "https://via.placeholder.com/300x200/333333/ffffff?text=BOTA+PVC+CANO+M√âDIO"
        },
        
        // Capas de Moto
        {
          REFERENCIA: "2410",
          DESCRI√á√ÉO: "CAPA DE MOTO PVC FORRADA COM FELTRO - P - AT√â 125CC",
          TAMANHOS: ["P"],
          TAMANHOS_ESPECIAIS: [],
          PRECO: 117.00,
          PRECO_ESPECIAL: 117.00,
          CATEGORIA: "Motos",
          IMAGEM: "https://via.placeholder.com/300x200/ff0000/ffffff?text=CAPA+MOTO+P"
        },
        {
          REFERENCIA: "2411",
          DESCRI√á√ÉO: "CAPA DE MOTO PVC FORRADA COM FELTRO - M -125CC - 150CC",
          TAMANHOS: ["M"],
          TAMANHOS_ESPECIAIS: [],
          PRECO: 121.00,
          PRECO_ESPECIAL: 121.00,
          CATEGORIA: "Motos",
          IMAGEM: "https://via.placeholder.com/300x200/ff0000/ffffff?text=CAPA+MOTO+M"
        },
        {
          REFERENCIA: "2412",
          DESCRI√á√ÉO: "CAPA DE MOTO PVC FORRADA COM FELTRO - G - 250CC - 450CC",
          TAMANHOS: ["G"],
          TAMANHOS_ESPECIAIS: [],
          PRECO: 125.00,
          PRECO_ESPECIAL: 125.00,
          CATEGORIA: "Motos",
          IMAGEM: "https://via.placeholder.com/300x200/ff0000/ffffff?text=CAPA+MOTO+G"
        },
        {
          REFERENCIA: "2413",
          DESCRI√á√ÉO: "CAPA DE MOTO PVC FORRADA COM FELTRO - GG - 450CC - 500CC - 750CC",
          TAMANHOS: ["GG"],
          TAMANHOS_ESPECIAIS: [],
          PRECO: 132.00,
          PRECO_ESPECIAL: 132.00,
          CATEGORIA: "Motos",
          IMAGEM: "https://via.placeholder.com/300x200/ff0000/ffffff?text=CAPA+MOTO+GG"
        },
        {
          REFERENCIA: "2414",
          DESCRI√á√ÉO: "CAPA DE MOTO PVC FORRADA COM FELTRO - EX - 750CC - 1200CC",
          TAMANHOS: ["EX"],
          TAMANHOS_ESPECIAIS: [],
          PRECO: 140.00,
          PRECO_ESPECIAL: 140.00,
          CATEGORIA: "Motos",
          IMAGEM: "https://via.placeholder.com/300x200/ff0000/ffffff?text=CAPA+MOTO+EX"
        },
        {
          REFERENCIA: "2415",
          DESCRI√á√ÉO: "CAPA DE MOTO PVC FORRADA COM FELTRO - EXG - ACIMA 1200CC",
          TAMANHOS: ["EXG"],
          TAMANHOS_ESPECIAIS: [],
          PRECO: 170.00,
          PRECO_ESPECIAL: 170.00,
          CATEGORIA: "Motos",
          IMAGEM: "https://via.placeholder.com/300x200/ff0000/ffffff?text=CAPA+MOTO+EXG"
        }
      ];

      let produtosFiltrados = [...produtosLoja];

      // Renderizar produtos
      function renderizarProdutos() {
        const grid = document.getElementById('produtos-grid');
        const nenhumProduto = document.getElementById('nenhum-produto');
        
        if (produtosFiltrados.length === 0) {
          grid.innerHTML = '';
          nenhumProduto.style.display = 'block';
          return;
        }
        
        nenhumProduto.style.display = 'none';
        grid.innerHTML = '';

        produtosFiltrados.forEach(produto => {
          const card = document.createElement('div');
          card.className = 'produto-card';
          
          const tamanhosTexto = Array.isArray(produto.TAMANHOS) 
            ? produto.TAMANHOS.join(', ') 
            : produto.TAMANHOS;

          // Combinar tamanhos normais e especiais
          const todosTamanhos = [...produto.TAMANHOS, ...produto.TAMANHOS_ESPECIAIS];
          
          let tamanhosHTML = `
            <div class="tamanhos-container">
              <label>Tamanhos & Quantidades:</label>
              <div class="tamanho-input-container">
                ${produto.TAMANHOS.map(tamanho => {
                  const tamanhoId = tamanho.replace(/[^a-zA-Z0-9]/g, "");
                  return `
                    <div>
                      <label for="quantidade-${produto.REFERENCIA}-${tamanhoId}">${tamanho}</label>
                      <input type="number" min="0" value="0" id="quantidade-${produto.REFERENCIA}-${tamanhoId}" data-preco="${produto.PRECO}">
                    </div>
                  `;
                }).join('')}
                ${produto.TAMANHOS_ESPECIAIS.map(tamanho => {
                  const tamanhoId = tamanho.replace(/[^a-zA-Z0-9]/g, "");
                  return `
                    <div style="border: 2px solid var(--warning-color); background: rgba(255, 193, 7, 0.1);">
                      <label for="quantidade-${produto.REFERENCIA}-${tamanhoId}" style="color: var(--warning-color); font-weight: 700;">${tamanho} ‚≠ê</label>
                      <input type="number" min="0" value="0" id="quantidade-${produto.REFERENCIA}-${tamanhoId}" data-preco="${produto.PRECO_ESPECIAL}">
                    </div>
                  `;
                }).join('')}
              </div>
            </div>
          `;

          card.innerHTML = `
            <div class="produto-imagem">
              <img src="${produto.IMAGEM}" alt="${produto.DESCRI√á√ÉO}" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;" onerror="this.style.display='none'; this.parentElement.innerHTML='üì¶';">
            </div>
            <div class="produto-categoria">${produto.CATEGORIA}</div>
            <div class="produto-ref">Ref: ${produto.REFERENCIA}</div>
            <div class="produto-descricao">${produto.DESCRI√á√ÉO}</div>
            <div class="produto-tamanhos">Tamanhos: ${tamanhosTexto}</div>
            <div class="produto-preco">R$ ${produto.PRECO.toFixed(2)}</div>
            ${tamanhosHTML}
            <button class="btn-adicionar" onclick="adicionarAoCarrinho('${produto.REFERENCIA}')">
              ‚ûï Adicionar ao Carrinho
            </button>
          `;

          grid.appendChild(card);
        });
        
        atualizarContadorProdutos();
      }

      // Alterar quantidade
      function alterarQuantidade(referencia, delta) {
        const input = document.getElementById(`qty-${referencia}`);
        const novaQuantidade = Math.max(0, parseInt(input.value) + delta);
        input.value = novaQuantidade;
        atualizarQuantidade(referencia);
      }

      // Atualizar quantidade
      function atualizarQuantidade(referencia) {
        const input = document.getElementById(`qty-${referencia}`);
        const quantidade = parseInt(input.value) || 0;
        
        // Se quantidade for 0, remover do carrinho se existir
        if (quantidade === 0) {
          removerDoCarrinho(referencia);
        }
      }

      // Adicionar ao carrinho (sistema atualizado)
      function adicionarAoCarrinho(referencia) {
        const produto = produtosLoja.find(p => p.REFERENCIA === referencia);
        if (!produto) return;

        let itemAdicionado = false;

        const handleItem = (tamanho, quantidade, preco) => {
          if (quantidade <= 0) return;
          
          itemAdicionado = true;
          const itemDesc = tamanho;
          const itemExistente = carrinhoItens.find(
            (item) =>
              item.REFERENCIA === produto.REFERENCIA &&
              item.tamanho === itemDesc &&
              item.preco === preco
          );

          if (itemExistente) {
            itemExistente.quantidade += quantidade;
          } else {
            carrinhoItens.push({
              REFERENCIA: produto.REFERENCIA,
              DESCRI√á√ÉO: produto.DESCRI√á√ÉO,
              tamanho: itemDesc,
              preco: preco,
              quantidade: quantidade,
              categoria: produto.CATEGORIA,
              imagem: produto.IMAGEM
            });
          }
        };

        // Processar tamanhos normais
        produto.TAMANHOS.forEach((tamanho) => {
          const tamanhoId = tamanho.replace(/[^a-zA-Z0-9]/g, "");
          const input = document.getElementById(`quantidade-${referencia}-${tamanhoId}`);
          if (input) {
            const quantidade = parseInt(input.value) || 0;
            const preco = parseFloat(input.dataset.preco) || produto.PRECO;
            handleItem(tamanho, quantidade, preco);
            
            // Limpar campo ap√≥s adicionar
            if (quantidade > 0) {
              input.value = 0;
            }
          }
        });

        // Processar tamanhos especiais
        produto.TAMANHOS_ESPECIAIS.forEach((tamanho) => {
          const tamanhoId = tamanho.replace(/[^a-zA-Z0-9]/g, "");
          const input = document.getElementById(`quantidade-${referencia}-${tamanhoId}`);
          if (input) {
            const quantidade = parseInt(input.value) || 0;
            const preco = parseFloat(input.dataset.preco) || produto.PRECO_ESPECIAL;
            handleItem(tamanho, quantidade, preco);
            
            // Limpar campo ap√≥s adicionar
            if (quantidade > 0) {
              input.value = 0;
            }
          }
        });

        if (itemAdicionado) {
          atualizarCarrinho();
          mostrarNotificacao(`${produto.DESCRI√á√ÉO} adicionado ao carrinho!`);
        } else {
          alert(`Por favor, informe a quantidade para pelo menos um tamanho do produto ${produto.DESCRI√á√ÉO}.`);
        }
      }

      // Remover do carrinho
      function removerDoCarrinho(referencia) {
        carrinhoItens = carrinhoItens.filter(item => item.REFERENCIA !== referencia);
        atualizarCarrinho();
      }

      // Atualizar quantidade no carrinho por √≠ndice
      function atualizarQuantidadeCarrinhoPorIndex(index, novaQuantidade) {
        if (novaQuantidade <= 0) {
          removerDoCarrinhoPorIndex(index);
          return;
        }
        
        if (carrinhoItens[index]) {
          carrinhoItens[index].quantidade = novaQuantidade;
          atualizarCarrinho();
        }
      }

      // Remover do carrinho por √≠ndice
      function removerDoCarrinhoPorIndex(index) {
        if (carrinhoItens[index]) {
          carrinhoItens.splice(index, 1);
          atualizarCarrinho();
        }
      }

      // Atualizar carrinho
      function atualizarCarrinho() {
        const content = document.getElementById('carrinho-content');
        const footer = document.getElementById('carrinho-footer');
        const badge = document.getElementById('carrinho-badge');
        const total = document.getElementById('carrinho-total');

        if (carrinhoItens.length === 0) {
          content.innerHTML = `
            <div id="carrinho-vazio" style="text-align: center; color: var(--text-muted); padding: 40px 20px;">
              <div style="font-size: 3rem; margin-bottom: 15px;">üõí</div>
              <p>Seu carrinho est√° vazio</p>
              <p style="font-size: 0.9rem; margin-top: 10px;">Adicione produtos para come√ßar suas compras</p>
            </div>
          `;
          footer.style.display = 'none';
          badge.style.display = 'none';
          return;
        }

        // Renderizar itens do carrinho
        content.innerHTML = '';
          carrinhoItens.forEach((item, index) => {
            const itemDiv = document.createElement('div');
            itemDiv.className = 'carrinho-item';
            
            itemDiv.innerHTML = `
              <div class="carrinho-item-imagem">
                <img src="${item.imagem}" alt="${item.DESCRI√á√ÉO}" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;" onerror="this.style.display='none'; this.parentElement.innerHTML='üì¶';">
              </div>
              <div class="carrinho-item-info">
                <div class="carrinho-item-nome">${item.DESCRI√á√ÉO}</div>
                <div class="carrinho-item-detalhes">Ref: ${item.REFERENCIA} | ${item.tamanho}</div>
                <div class="carrinho-item-preco">R$ ${(item.preco * item.quantidade).toFixed(2)}</div>
                <div class="carrinho-item-quantidade">
                  <button class="quantidade-btn" onclick="atualizarQuantidadeCarrinhoPorIndex(${index}, ${item.quantidade - 1})">-</button>
                  <input type="number" value="${item.quantidade}" min="1" onchange="atualizarQuantidadeCarrinhoPorIndex(${index}, parseInt(this.value))">
                  <button class="quantidade-btn" onclick="atualizarQuantidadeCarrinhoPorIndex(${index}, ${item.quantidade + 1})">+</button>
                  <button class="btn-remover-item" onclick="removerDoCarrinhoPorIndex(${index})">üóëÔ∏è</button>
                </div>
              </div>
            `;
            
            content.appendChild(itemDiv);
          });

        // Calcular total
        const subtotal = carrinhoItens.reduce((total, item) => total + (item.preco * item.quantidade), 0);
        const desconto = formaPagamento === 'vista' ? subtotal * 0.05 : 0;
        const totalFinal = subtotal - desconto;

        total.textContent = `R$ ${totalFinal.toFixed(2)}`;
        badge.textContent = carrinhoItens.reduce((total, item) => total + item.quantidade, 0);
        badge.style.display = 'block';
        footer.style.display = 'block';

        // Atualizar info de desconto
        const descontoInfo = document.getElementById('desconto-info');
        const valorDesconto = document.getElementById('valor-desconto');
        
        if (formaPagamento === 'vista' && desconto > 0) {
          valorDesconto.textContent = `R$ ${desconto.toFixed(2)}`;
          descontoInfo.style.display = 'block';
        } else {
          descontoInfo.style.display = 'none';
        }

        // Habilitar/desabilitar bot√£o finalizar
        const btnFinalizar = document.getElementById('btn-finalizar');
        btnFinalizar.disabled = carrinhoItens.length === 0;
      }

      // Selecionar forma de pagamento
      function selecionarPagamento(tipo) {
        formaPagamento = tipo;
        
        // Atualizar visual
        document.querySelectorAll('.opcao-pagamento').forEach(opcao => {
          opcao.classList.remove('selecionada');
        });
        
        const opcaoSelecionada = document.querySelector(`input[value="${tipo}"]`).closest('.opcao-pagamento');
        opcaoSelecionada.classList.add('selecionada');
        
        // Marcar radio button
        document.querySelector(`input[value="${tipo}"]`).checked = true;
        
        // Atualizar carrinho para recalcular total
        atualizarCarrinho();
      }

      // Toggle carrinho
      function toggleCarrinho() {
        const sidebar = document.getElementById('carrinho-sidebar');
        const overlay = document.getElementById('overlay');
        
        sidebar.classList.toggle('open');
        overlay.classList.toggle('show');
      }

      // Finalizar pedido
      async function finalizarPedido() {
        if (carrinhoItens.length === 0) {
          alert('Seu carrinho est√° vazio!');
          return;
        }

        if (!formaPagamento) {
          alert('Por favor, selecione uma forma de pagamento.');
          return;
        }

        try {
          // Calcular totais
          const subtotal = carrinhoItens.reduce((total, item) => total + (item.PRECO * item.quantidade), 0);
          const desconto = formaPagamento === 'vista' ? subtotal * 0.05 : 0;
          const totalFinal = subtotal - desconto;

          // Preparar dados do pedido
          const pedidoData = {
            empresa: 'distribuicao',
            descricao: `Pedido Distribui√ß√£o - ${carrinhoItens.length} itens`,
            dados: {
              cliente: clienteData,
              itens: carrinhoItens,
              subtotal: subtotal,
              desconto: desconto,
              total: totalFinal,
              formaPagamento: formaPagamento,
              data: new Date().toISOString(),
              origem: 'Loja Distribui√ß√£o',
              observacoes: `Pedido via Loja Distribui√ß√£o - Pagamento ${formaPagamento === 'vista' ? '√† vista com 5% desconto' : 'a prazo'}`
            }
          };

          // Usar sistema offline
          const result = await window.offlineSystem.tryToSendOrder(pedidoData);
          
          if (result.success) {
            if (result.online) {
              alert('‚úÖ Pedido enviado com sucesso! Voc√™ ser√° redirecionado para seus pedidos.');
            } else {
              alert('üì± Sem conex√£o! Pedido salvo localmente e ser√° enviado automaticamente quando a conex√£o retornar. Voc√™ ser√° redirecionado para seus pedidos.');
            }
            
            // Limpar carrinho
            carrinhoItens = [];
            atualizarCarrinho();
            
            // Redirecionar para a p√°gina de pedidos
            window.location.href = 'pedidos.html';
          } else {
            throw new Error('Erro ao processar pedido');
          }
        } catch (error) {
          console.error('Erro ao finalizar pedido:', error);
          alert('Erro ao finalizar pedido. Tente novamente.');
        }
      }

      // Mostrar notifica√ß√£o
      function mostrarNotificacao(mensagem) {
        if (window.showNotification) {
          window.showNotification(mensagem, 'success');
        } else {
          alert(mensagem);
        }
      }

      // Inicializar p√°gina
      if (checkAuth()) {
        preencherInformacoesCliente();
        renderizarProdutos();
        atualizarCarrinho();
        
        // Adicionar event listeners para filtros
        document.getElementById('busca-produto').addEventListener('input', aplicarFiltros);
        document.getElementById('filtro-categoria').addEventListener('change', aplicarFiltros);
        document.getElementById('filtro-preco').addEventListener('change', aplicarFiltros);
        document.getElementById('ordenar-por').addEventListener('change', aplicarFiltros);
      }

      // Sistema de filtros
      function aplicarFiltros() {
        const busca = document.getElementById('busca-produto').value.toLowerCase();
        const categoria = document.getElementById('filtro-categoria').value;
        const preco = document.getElementById('filtro-preco').value;
        const ordenar = document.getElementById('ordenar-por').value;

        produtosFiltrados = produtosLoja.filter(produto => {
          // Filtro de busca
          const matchBusca = !busca || 
            produto.REFERENCIA.toLowerCase().includes(busca) ||
            produto.DESCRI√á√ÉO.toLowerCase().includes(busca) ||
            produto.CATEGORIA.toLowerCase().includes(busca);

          // Filtro de categoria
          const matchCategoria = !categoria || produto.CATEGORIA === categoria;

          // Filtro de pre√ßo
          let matchPreco = true;
          if (preco) {
            const precoProduto = produto.PRECO;
            switch (preco) {
              case '0-50':
                matchPreco = precoProduto <= 50;
                break;
              case '50-100':
                matchPreco = precoProduto > 50 && precoProduto <= 100;
                break;
              case '100-150':
                matchPreco = precoProduto > 100 && precoProduto <= 150;
                break;
              case '150-200':
                matchPreco = precoProduto > 150 && precoProduto <= 200;
                break;
              case '200+':
                matchPreco = precoProduto > 200;
                break;
            }
          }

          return matchBusca && matchCategoria && matchPreco;
        });

        // Ordena√ß√£o
        switch (ordenar) {
          case 'nome':
            produtosFiltrados.sort((a, b) => a.DESCRI√á√ÉO.localeCompare(b.DESCRI√á√ÉO));
            break;
          case 'preco-asc':
            produtosFiltrados.sort((a, b) => a.PRECO - b.PRECO);
            break;
          case 'preco-desc':
            produtosFiltrados.sort((a, b) => b.PRECO - a.PRECO);
            break;
          case 'categoria':
            produtosFiltrados.sort((a, b) => a.CATEGORIA.localeCompare(b.CATEGORIA));
            break;
        }

        renderizarProdutos();
      }

      // Atualizar contador de produtos
      function atualizarContadorProdutos() {
        const contador = document.getElementById('contador-produtos');
        const total = produtosLoja.length;
        const filtrados = produtosFiltrados.length;
        
        if (filtrados === total) {
          contador.textContent = `Mostrando todos os ${total} produtos`;
        } else {
          contador.textContent = `Mostrando ${filtrados} de ${total} produtos`;
        }
      }

      // Limpar filtros
      function limparFiltros() {
        document.getElementById('busca-produto').value = '';
        document.getElementById('filtro-categoria').value = '';
        document.getElementById('filtro-preco').value = '';
        document.getElementById('ordenar-por').value = 'nome';
        
        produtosFiltrados = [...produtosLoja];
        renderizarProdutos();
      }
    </script>
  </body>
</html>
